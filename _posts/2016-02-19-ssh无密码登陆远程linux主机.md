---
layout: post
title:  "ssh无密码登陆远程linux主机"
date:   2016-2-19 星期五  19:41:11  
categories: jekyll update
---

3个步骤的简单设置而无需输入密码就能登录远程Linux主机

ssh-keygen 创建公钥和密钥。

ssh-copy-id 把本地主机的公钥复制到远程主机的authorized_keys文件上。

ssh-copy-id 也会给远程主机的用户主目录（home）和~/.ssh, 和~/.ssh/authorized_keys设置合适的权限 

###1、用 ssh-key-gen 在本地主机上创建公钥和密钥###

	ligh@local-host$ ssh-keygen -t  rsa
	Enter file in which to save the key (/home/jsmith/.ssh/id_rsa):[Enter key]
	Enter passphrase (empty for no passphrase): [Press enter key]
	Enter same passphrase again: [Pess enter key]
	Your identification has been saved in /home/jsmith/.ssh/id_rsa.
	Your public key has been saved in /home/jsmith/.ssh/id_rsa.pub.
	The key fingerprint is: 33:b3:fe:af:95:95:18:11:31:d5:de:96:2f:f2:35:f9
	ligh@local-host

###2、用 ssh-copy-id 把公钥复制到远程主机上###

	ligh@local-host$ ssh-copy-id -i ~/.ssh/id_rsa.pub  root@192.168.0.3
	ligh@remote-host's password:
	Now try logging into the machine, with ―ssh ?remote-host'‖, and check in:
	.ssh/authorized_keys to make sure we haven't added extra keys that you weren't expecting.

[注: ssh-copy-id 把密钥追加到远程主机的 .ssh/authorized_key 上.]

###3、直接登录远程主机###

	ligh@local-host$ ssh remote-host
	Last login: Sun Nov 16 17:22:33 2008 from 192.168.1.2

[注: SSH 不会询问密码.]

	ligh@remote-host$

[注: 你现在已经登录到了远程主机上]

###常见问题###

[ssh登录慢，等待输入密码时间长的解决办法？]

有时候在ssh远程登录到其他主机上时发现登录时间太长，要等待很久才会出现输入密码的提示，发现主要有两个问题会导致ssh登录慢：

1、使用了dns反查，这样的话当ssh某个IP时，系统会试图通过DNS反查相对应的域名，如果DNS中没有这个IP的域名解析，则会等到DNS查询超时才会进行下一步，消耗很长时间。修改方式:

	vim /etc/ssh/sshd_config
	增加一行记录：UseDNS no

默认情况下会有一行被注释掉的记录#UseDNS yes，虽然这条记录被注释掉了，但ssh缺省情况下UseDNS的值是yes，所以要显式的指定该值为no。

重新启动ssh服务

远程登录会快很多。或者如果机器不用上外网，直接删除/etc/resolv.conf下的内容

2、这种情况在本地主机或远程主机启动图形的情况下比较明显，该参数似乎是在做图形方面的认证，具体功能还不清楚，但修改以后可以明显提高ssh远程登录速度。

	vim /etc/ssh/sshd_config
	修改GSSAPIAuthentication参数为 no，默认是yes

重新启动ssh服务