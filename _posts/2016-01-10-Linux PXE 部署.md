---
layout: post
title:  "Linux PXE 部署"
date:   2016-1-10 星期日  19:09:50 
categories: jekyll update
---

###一、基础环境准备###

Linux配置静态IP-192.168.5.1

	# vim /etc/sysconfig/network-scripts/ifcfg-eth0
	DEVICE=eth0
	ONBOOT=yes
	BOOTPROTO=static
	IPADDR=192.168.5.1
	NETMASK=255.255.255.0
	:x  --保存退出
	#service network restart
	#service iptables stop

###二、准备安装镜像###

	#mount /dev/cdrom /media/
	#mkdir /centos_ios
	# mkdir /ks
	#cp -rf /media/* /centos_ios/
	# yum -y install nfs-utils
	# service nfs start
	#vim /etc/exports
	/centos_ios/ 192.168.5.0/24(ro)
	/ks/ 192.168.5.0/24(ro)

###三、安装并启用TFTP###

	# yum -y install tftp-server
	# vim /etc/xinetd.d/tftp

![](http://7xppz2.com1.z0.glb.clouddn.com/26.jpg)

	# service xinetd start

###四、准备linux内核、初始化镜像文件###

	# cp /centos_ios/images/pxeboot/{vmlinuz,initrd.img} /var/lib/tftpboot/

###五、准备PXE引导程序、启动菜单文件###

	# yum -y install syslinux
	# cp /usr/share/syslinux/{pxelinux.0,vesamenu.c32} /var/lib/tftpboot/
	# mkdir /var/lib/tftpboot/pxelinux.cfg
	# vim /var/lib/tftpboot/pxelinux.cfg/default
	default auto   
	prompt 0
	label auto
	   kernel vmlinuz
       append ks=nfs:192.168.5.1:/ks/ks.cfg ksdevice=link initrd=initrd.img
	:x

###六、安装并启用DHCP服务###

	# yum -y install dhcp
	# vim /etc/dhcp/dhcpd.conf
	…….
	subnet 192.168.5.0 netmask 255.255.255.0 {
	        option routers 192.168.5.1;
	        option domain-name-servers 192.168.5.1,202.106.0.20;
	        range 192.168.5.100 192.168.5.200;
	        next-server 192.168.5.1;
	        filename "pxelinux.0";
	}
	：x
	# service dhcpd start

###七、准备安装应答文件###

	# yum -y install system-config-kickstart

进入图形界面-应用程序-系统工具-kickstart

配置安装应答参数

![](http://7xppz2.com1.z0.glb.clouddn.com/27.jpg)

![](http://7xppz2.com1.z0.glb.clouddn.com/28.jpg)

![](http://7xppz2.com1.z0.glb.clouddn.com/29.jpg)

	/boot分区选择200M
	Swap分区：如果服务器内存在8G以上则可以不用分区，在8G以下，则swap分区大小划分为(真实内存x2)
	剩余全部为/分区

![](http://7xppz2.com1.z0.glb.clouddn.com/30.jpg)

	一般DELL服务器网卡为em

![](http://7xppz2.com1.z0.glb.clouddn.com/31.jpg)

安装包参考:

	基本系统
		perl支持
		兼容程序库
		基本
		大系统性能
		性能工具
		硬件监控工具
	开发
		开发工具
		服务器开发平台
		附件开发
	数据库
		MySQL数据库客户端
	服务器
		NFS文件服务器
		系统管理工具
	系统管理
		SNMP支持
		系统管理

配置完后点击左上角文件保存到刚才创建的/ks目录里

###八、添加服务开机启动###

	# chkconfig --level 35 xinetd on
	# chkconfig --level 35 dhcpd on
	# chkconfig --level 35 nfs on

###九、初始化###

	配置IP后
	# mkdir /share
	# mount 192.168.0.71:/vol/vol2 /share
	# bash /share/perdir/chaichuan/shell/server_init_02.sh
